---
author: Jieun Park
---

## Correlation and Regression

### Correlation
We check if a linear correlation exists between two variables using `cor()` function.

```{r}
# We can calculate the correlation coefficient between x and y with the following code.
# cor(x, y)
```


```{r}
library(tidyverse)
library(patchwork)
data("mtcars")
names(mtcars)
```



```{r, message = FALSE}
attach(mtcars)
# positive correlation
qplot(wt, disp, data = mtcars) +
  geom_text(aes(x=2, y=400, label="r = 0.888"))
cor(wt, disp)
# negative correlation
qplot(mpg, wt, data = mtcars)  +
  geom_text(aes(x=30, y=5, label="r = - 0.868"))
cor(mpg, wt)
# no correlation
qplot(drat, qsec, data = mtcars)  +
  geom_text(aes(x=4.5, y=22, label="r = 0.091"))
cor(drat, qsec)
```

* `wt` and `disp` have a positive correlation with r =`r round(cor(wt, disp), 3)`. 
* `wt` and `disp` have a negative correlation with r = `r round(cor(mpg, wt), 3)`. 
* `wt` and `disp` does not have a significant correlation with r = `r round(cor(wt, qsec), 3)`. 

### Regression
Assume we have a data set `data` with `x` and `y` variables and we check their linear relationship. We can find the slope and the intercept of the estimated regression line using the following code.
```{r}
# res <- lm(y ~ x, data)
# summary(res)
```

For example, we can find the regression line equation between `disp`(x, predictor) and `wt`(y, response) as below.
```{r}
library(tidyverse)
data("mtcars")

res <- lm(wt ~ disp, mtcars)
summary(res)
```
The estimated regression line is $\textrm{wt} = 1.600 + 0.007\textrm{disp}$ since the intercept is `r round(summary(res)$coef[1],3)` and the slope is `r round(summary(res)$coef[2],3)`. Both of them are significantly different from 0 with a significance level $\alpha = 0.05$. It means that one inch increase in `disp` (displacement) makes 7 lbs increase in `wt` (weight). On average, if a car has a one-inch longer displacement, it is 7 pounds heavier.

If a car has 200 inches displacement, then its estimated weight can be calculated as
$$ 1.600 + 0.007\cdot200 = 3000 \textrm{ lbs} $$ 



```{r, echo =FALSE, message=FALSE}
ggplot(mtcars, aes(x=disp, y=wt)) + 
  geom_point()+
  geom_smooth(method=lm, se=FALSE) +
  geom_text(aes(x = 150, y = 4.5, label = "wt = 1.600 + 0.007disp"))

```





